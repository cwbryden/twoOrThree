#
# This is a Shiny web application. You can run the application by clicking
# the 'Run App' button above.
#
# Find out more about building applications with Shiny here:
#
#    http://shiny.rstudio.com/
#

library(shiny)
library(readr)

data <- read_csv("data.csv")
data$X1 <- c("Kevin Durant",
             "Steph Curry",
             "Damian Lillard",
             "LeBron James",
             "Saddiq Bey",
             "James Harden",
             "Kyrie Irving",
             "Trae Young",
             "Lamelo Ball",
             "Luka Doncic")

# Define UI for application that draws a histogram
ui <- fluidPage(
  
  # Application title
  titlePanel("Points by Two Or Three by Player"),
  
  # Sidebar with a slider input for number of bins 
  sidebarLayout(
    sidebarPanel(
      textInput("shots",
                  "Number of shots:"),
      
      selectInput(inputId = "player",
                  label = "What player would you like to simmulate?",
                  choices = c("Kevin Durant",
                              "Steph Curry",
                              "Damian Lillard",
                              "LeBron James",
                              "Saddiq Bey",
                              "James Harden",
                              "Kyrie Irving",
                              "Trae Young",
                              "Lamelo Ball",
                              "Luka Doncic"))),
    
    # Show a plot of the generated distribution
    mainPanel(
      plotOutput("linePlot"),
      textOutput("selected_var")
    )
  )
)

# Define server logic required to draw a histogram
server <- function(input, output) {
  
  output$selected_var <- renderText({
    paste("You have selected", input$player)
    paste(input$player, "has a 2pt score of ", data$`2pt%`[which(data$X1==input$player)],
          "and a 3 pt score of ", data$`3pt%`[which(data$X1==input$player)])
  })
  
  shot_input <- reactive(input$shots)
 shot <- c("Make", "Miss")
  #makeOrMiss <- function(number_of_shots, player){
    for(i in 1: shot_input){
      shot2 <- sample(shot, size = 1, replace = TRUE, prob = c(data$`2pt%`[which(data$X1==input$player)]))
      shot3 <- sample(shot, size = 1, replace = TRUE, prob = c(data$`3pt%`[which(data$X1==input$player)]))
      
      if(shot2 == "Make"){
        success2 <- success2 + 1
        points2 <- 2 * success2
      }
      if(shot3 == "Make"){
        success3 <- success3 + 1
        points3 <- 3 * success
      }
    
    
  #return(points2,points3)
    data2 <- data.frame(cbind(points2,points3))
    }
  #}
  
  
    output$linePlot <- renderPlot({
    #ggplot2()
    # generate bins based on input$bins from ui.R
    #x    <- faithful[, 2]
    #bins <- seq(min(x), max(x), length.out = input$bins + 1)
    
    # draw the histogram with the specified number of bins
    #hist(x, breaks = bins, col = 'darkgray', border = 'white')
  })
  
}


# Run the application 
shinyApp(ui = ui, server = server)



# nba_df <- read_csv("C:/Users/Christopher/Downloads/Stat 327/Final Project/2or3/nba2or3_2021_player_stats.csv")
# #View(nba_df)
# 
# nba_df <- data.frame(nba_df)
# #View(nba_df)
# 
# twoOrThree <- function(n, player){
# 
#     two <- 0
#     three <- 0
#     if (player == kevinDurant){
#         two <- nba_df$cells$getvalue(1,3)
#         three <- nba_df$cells$getvalue(1,4)
#     }
# 
# }
# 
# twoOrThree(1, kevinDurant)


# makeOrMiss <- function(number_of_shots, player){
#   success <- 0
#   points <- 3 * success
#   for(i in 1: number_of_shots){
#     shot2 <- rbinom(1, size = number_of_shots, replace = TRUE, prob = data$`2pt%`[which(data$X1==input$player))
#      shot3 <- rbinom(1, size = number_of_shots, replace = TRUE, prob = data$`3pt%`[which(data$X1==input$player)])
#     if(shot == 1){
#       success <- success + 1
#       points <- 3 * success
#     }
#   }
#   print(points())
# }
